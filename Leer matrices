Option Explicit
Sub matriz()
    Dim i As Long
    Dim j As Long
    Dim fil As Long
    Dim col As Long
    Dim v() As Double
    
    Call dimn("hoja1", i, j, fil, col)
    Call leerm("hoja1", i, j, fil, col, v)
    Call escrm("hoja1", i, j, fil, col, v)
End Sub

Sub dimn(archivo, i, j, fil, col)
    Worksheets("hoja1").Select
    
    i = 1
    While (Cells(i, 1) <> "")
        i = i + 1
    Wend
    fil = i - 1
    
    j = 1
    While (Cells(1, j) <> "")
        j = j + 1
    Wend
    col = j - 1
End Sub

Sub leerm(archivo, i, j, fil, col, v)
    ReDim v(fil, col)
    
    For i = 1 To fil
        For j = 1 To col
            v(i, j) = Cells(i, j)
        Next j
    Next i
End Sub

Sub escrm(archivo, i, j, fil, col, v)
    Worksheets("hoja2").Select
    
    For i = 1 To fil
        For j = 1 To col
            Cells(i, j) = v(i, j)
        Next j
    Next i
End Sub
